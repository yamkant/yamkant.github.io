---
layout: archive
title:  "[Study] 파이썬을 활용한 DDD"
date:   2023-11-14 00:05:07 +0900
categories: 
    - Study
---

## DDD란?
- 소프트웽어가 해결하는 문제인 도메인에 집중하는 소프트웨어 개발 방법론입니다.
- 따라서, 개발자와 도메인 전문가의 협업이 매우 중요합니다.
- 유비쿼터스 랭기지를 확립하여 팀 내에서 용어를 통일하고, 같은 개념을 떠올리도록 훈련하는 것이 중요합니다.

#### 장점
- 소프트웨어와 비즈니스가 이원화되는 것을 방지하여, 개발자와 비개발자들이 소통하는데 편리합니다.  
  (일밙적으로, 개발자들은 데이터 기반으로, 비개발자들은 추상적인 개념 기반으로 이야기합니다.)
- 즉, 서로의 멘탈 모델을 맞추어 불필요한 소통 비용을 줄여나갈 수 있습니다.
- 도메인 영역에 집중하고, 도메인이 아닌 영역은 철저히 도메인을 돕도록 의존성을 관리하여 느슨한 결합을 유지합니다.

## DDD 구조
### Domain Layer
- 시스템의 중심이 되는 비즈니스 로직을 다룹니다.
- 기술적인 제약 등에 영향을 받지 않아야하기 때문에, std library와 순수 Python으로 구현하는 것을 권장합니다.
- 3rd party 라이브러리는 도메인 문제라기보다, 문제 해결을 돕는 도구이기 때문입니다.

#### Entity
- 고유의 식별자를 갖는 객체입니다. 객체의 정체성이 고유 식별자에 의해 구분됩니다.
- 이커머스라면, 고객, 상품들을 의미합니다.

#### Value Object
- 값 자체로서 의미를 갖는 객체로, 도메인 내의 값이나 성질을 표현하는 객체입니다.
- 돈, 위치, 날짜 등을 의미합니다. 다른 화폐가 같은 값을 가지면, 물리적으로 동등하다고 할 수 있습니다.

#### Aggregate
- 단일 객체로 취급되는 Entity와 VO의 묶음입니다.
- 주문은 고객과 상품 금액으로 Entity와 VO로 모여있으며, 이는 하나의 주문이라고 할 수 있습니다.

#### Aggregate Root
- Aggregate에 접근하거나 조작하기 위한 entry point Entity입니다.

#### Exception
- 도메인 내에서 발생하는 예외 상황이나 에러입니다. 미리 설정해두고 일어날 수 있는 상황을 예측 가능하도록 합니다.

#### Service
- 다수의 Entity나 VO에 의한 동작이나 연산의 모음입니다.

### Infrastructure Layer
- 도메인을 도와서 기술적인 문제를 담당하는 계층으로, 도메인에 영향을 주면 안됩니다.
- 기술적인 인프라를 제공하고 어플리케이션을 돕는 계층입니다.
- 데이터베이스, 캐싱, 로깅, 클라우드 서비스 활용, 외부 API 사용 등에 대한 기술적 고민이 이루어지는 영역입니다.
- 이 영역에서 기술적인 구현들이 추상화되며, 추상화된 인터페이스는 다른 계층에서 호출되어 사용됩니다.

#### Database
- 영속적인 데이터를 관리하며, RDB, NoSQL등 DB를 교체하여도 추상화되어있기 때문에 문제가 없어야합니다.

#### Caching
- 임시적으로 데이터를 관리하는 영역입니다.

#### Logging
- 운영 및 디버깅을 위한 로그를 처리합니다.

#### External API
- 클라우드 서비스, 결제 API 등 외부에서 사용하는 API를 설정합니다.

#### Library
- 웹 프레임워크와 같은 3rd party library를 구성합니다.

### Application Layer
- 도메인 계층과 프레젠테이션 계층을 이어주며, 비즈니스 로직과 인프라 등을 활용하여 Use Case를 구현합니다.
- 실제 사용자 영역에서 Use Case를 구현합니다. 회원가입, 로그인 등의 기능들입니다.

#### Use Case
- 인프라스트럭처 레이어에서 제공하는 도구들을 조합하여, 유저 관점의 비즈니스 유즈케이스를 구현합니다.  
  (회원가입, 로그인, 상품조회, 상품구매 등)
- 회원가입: 유저로부터 아이디와 패스워드를 입력 받아 유효한 값인지 검증한 이후 저장하는 기능입니다.
- 로그인: 회원가입한 유저가 시스템을 사용하고자 할 때 아이디와 패스워드를 받아 인증하는 기능입니다.
- 유즈 케이스를 잘 설정하면 커뮤니케이션과 협업이 용이하며 테스트가 편리합니다.

#### CQRS
- Command Query Responsibility Segregation
- Read(Query)와 Write(Command)의 권한과 책임을 분리하는 패턴입니다.
- 데이터를 읽는 저장소와 쓰는 저장소를 독립적으로 저장할 수 있게 됩니다.

#### Query
- 데이터 수정 없이 읽어오는 동작입니다. (Read)

#### Command
- 시스템의 상태를 변경하는 동작입니다. (Create, Update, Delete)

### Presentation Layer
- 유저 인터페이스를 제공하는 계층으로, Rest API, GraphQL, gRPC, CLI 등 입니다.
- 입출력 validation/serialization, 데이터 표현 등이 이에 포함됩니다.

#### API
- REST, GraphQL, gRPC, CLI등 유저에게 제공하는 인터페이스입니다.

#### Input
- HTTP Request, GraphQL Query/Mutation, gRPC protocol buffers
- Data Validation, Deserialization

#### Output
- HTTP Response(JSON), gRPC protocol buffers
- Serialization